<%= render Ui::ComponentHeaderComponent.new(
  title: "Table 表格",
  description: "展示行列数据。",
  when_to_use: ["当有大量结构化的数据需要展现时。", "需要对数据进行排序、搜索、分页、自定义操作等复杂行为时。"]
) %>

<% 
   user_struct = Struct.new(:id, :name, :role, :status, :email, :phone, :address)
   users = [
     user_struct.new(1, "John Brown", "Developer", :success, "john@example.com", "123-456-7890", "New York No. 1 Lake Park"),
     user_struct.new(2, "Jim Green", "Designer", :processing, "jim@example.com", "234-567-8901", "London No. 1 Lake Park")
   ]
%>

<%= render Ui::ExampleComponent.new(
  title: "基础表格 DSL",
  description: "使用 Block DSL 定义列。支持自定义 HTML 内容。",
  language: :erb,
  code: table_basic_code
) do %>
  <%= ant_table(users) do |t| %>
     <% t.column "ID", class: "w-20" do |u| %>
       <%= u.id %>
     <% end %>
     <% t.column "Name" do |u| %>
       <div class="font-medium"><%= u.name %></div>
     <% end %>
     <% t.column "Tags" do |u| %>
       <%= ant_tag u.role %>
       <%= ant_tag "Nice", color: u.status %>
     <% end %>
     <% t.column "Action", class: "text-blue-600" do |u| %>
       <a>Invite <%= u.name %></a>
     <% end %>
  <% end %>
<% end %>

<%= render Ui::ExampleComponent.new(
  title: "自动推断列 (Auto Columns)",
  description: "懒人模式：如果未传入 block，组件将自动根据第一条数据推断列名并渲染。支持 ActiveRecord, Struct 和 Hash。",
  language: :erb,
  code: table_auto_code
) do %>
  <% simple_users = users.map { |u| { id: u.id, name: u.name, role: u.role } } %>
  <%= ant_table(simple_users) %>
<% end %>

<% 
  current_page = (params[:page] || 1).to_i
  per_page = (params[:per_page] || 10).to_i
  all_large_users = (1..100).map do |i|
    user_struct.new(i, "User #{i}", "Role #{i}", :default, "user#{i}@example.com", "555-010#{i}", "Long Address Street No. #{i}, Some City, Some Country")
  end
  start_index = (current_page - 1) * per_page
  paged_users = all_large_users[start_index, per_page] || []
  total_count = all_large_users.size
%>

<%= render Ui::ExampleComponent.new(
  title: "高级特性：固定表头、列固定与分页",
  description: "支持 sticky_header, sticky: :left/:right 以及分页插槽。点击分页按钮查看 URL 变化。",
  language: :erb,
  code: table_advanced_code
) do %>
  <div class="max-w-full">
    <%= ant_table(paged_users, sticky_header: true, paginate: ant_pagination(current_page: current_page, total_count: total_count, per_page: per_page)) do |t| %>
       <% t.column "ID", sticky: :left, class: "w-16 font-mono text-center border-r border-gray-200" do |u| %>
         <%= u.id %>
       <% end %>
       <% t.column "Name", class: "w-40 font-medium" do |u| %>
         <%= u.name %>
       <% end %>
       <% t.column "Email", class: "w-48" do |u| %>
         <%= u.email %>
       <% end %>
       <% t.column "Address (Long Content)", class: "w-[300px]" do |u| %>
         <%= u.address %>
       <% end %>
       <% t.column "Action", sticky: :right, class: "w-20 text-center border-l border-gray-200" do |u| %>
         <a href="#" class="text-blue-600 font-medium">Edit</a>
       <% end %>
    <% end %>
  </div>
<% end %>

<h3 class="text-xl font-bold text-gray-800 mb-4 mt-12 border-b pb-2 text-pink-600">API</h3>
<%= render Ui::ApiTableComponent.new do |api| %>
  <% api.row "collection", "要渲染的数据集合 (Enumerable)", "Array | ActiveRecord::Relation", "required" %>
  <% api.row "sticky_header", "是否开启固定表头。开启后表格高度固定并支持纵向滚动", "Boolean", "false" %>
  <% api.row "paginate", "分页内容插槽。通常配合 `ant_pagination` 使用", "HTML String | Component", "nil" %>
  <% api.row "class", "外层容器自定义 CSS 类", "String", "nil" %>
<% end %>

<h4 class="font-bold text-gray-700 mt-10 mb-4 flex items-center">
  <span class="bg-gray-100 px-2 py-1 rounded text-pink-600 font-mono mr-2">t.column</span> DSL 参数
</h4>
<%= render Ui::ApiTableComponent.new do |api| %>
  <% api.row "header", "列标题", "String", "required" %>
  <% api.row "sticky", "列固定方向。开启后横向滚动时该列将固定", "Symbol (:left | :right)", "nil" %>
  <% api.row "class", "列（th/td）的自定义 CSS 类", "String", "nil" %>
  <% api.row "block", "列内容渲染 Block，接收当前行对象 item", "Block(item)", "required" %>
<% end %>
